<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><style type="text/css">@import url(https://themes.googleusercontent.com/fonts/css?kit=fpjTOVmNbO4Lz34iLyptLROjXfSpIU_1TsQlCJ7q4WlXEixY9aqhie8CVYCrTb1E);ol{margin:0;padding:0}table td,table th{padding:0}.c0{color:#007f00;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:9.5pt;font-family:"Consolas";font-style:normal}.c22{margin-left:17pt;padding-top:0.8pt;text-indent:-10.5pt;padding-bottom:0pt;line-height:1.075;text-align:left;margin-right:18.6pt}.c13{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:10.5pt;font-family:"Consolas";font-style:normal}.c14{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:10pt;font-family:"Consolas";font-style:normal}.c20{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:1pt;font-family:"Consolas";font-style:normal}.c8{color:#0000ff;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:9.5pt;font-family:"Consolas";font-style:normal}.c4{color:#7f7f7f;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:9.5pt;font-family:"Consolas";font-style:normal}.c3{color:#ff00ff;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:9.5pt;font-family:"Consolas";font-style:normal}.c5{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:9.5pt;font-family:"Consolas";font-style:normal}.c17{margin-left:6.5pt;padding-top:0.8pt;padding-bottom:0pt;line-height:1.075;text-align:left;margin-right:223.2pt}.c24{margin-left:27.4pt;padding-top:0.8pt;padding-bottom:0pt;line-height:1.075;text-align:left;margin-right:48.2pt}.c18{margin-left:6.5pt;padding-top:0pt;padding-bottom:0pt;line-height:1.075;text-align:left;margin-right:273.9pt}.c7{margin-left:6.5pt;padding-top:0pt;padding-bottom:0pt;line-height:1.075;text-align:left;margin-right:258.1pt}.c16{margin-left:6.5pt;padding-top:0.8pt;padding-bottom:0pt;line-height:1.075;text-align:left;margin-right:97.4pt}.c21{margin-left:6.5pt;padding-top:0pt;padding-bottom:0pt;line-height:1.075;text-align:left;margin-right:223.2pt}.c19{margin-left:5pt;padding-top:2.2pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c15{margin-left:6.5pt;padding-top:1.1pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c1{padding-top:0.6pt;padding-bottom:0pt;line-height:1.0;text-align:left;height:11pt}.c2{margin-left:6.5pt;padding-top:0.8pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c9{margin-left:6.5pt;padding-top:0pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c23{margin-left:5.3pt;padding-top:0pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c10{margin-left:27.4pt;padding-top:0.8pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c12{padding-top:0.3pt;padding-bottom:0pt;line-height:1.0;text-align:left;height:11pt}.c11{margin-left:27.4pt;padding-top:0pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c6{background-color:#ffffff;max-width:472pt;padding:73pt 70pt 14pt 70pt}.title{padding-top:24pt;color:#000000;font-weight:700;font-size:36pt;padding-bottom:6pt;font-family:"Calibri";line-height:1.0;page-break-after:avoid;text-align:left}.subtitle{padding-top:18pt;color:#666666;font-size:24pt;padding-bottom:4pt;font-family:"Georgia";line-height:1.0;page-break-after:avoid;font-style:italic;text-align:left}li{color:#000000;font-size:11pt;font-family:"Calibri"}p{margin:0;color:#000000;font-size:11pt;font-family:"Calibri"}h1{padding-top:24pt;color:#000000;font-weight:700;font-size:24pt;padding-bottom:6pt;font-family:"Calibri";line-height:1.0;page-break-after:avoid;text-align:left}h2{padding-top:18pt;color:#000000;font-weight:700;font-size:18pt;padding-bottom:4pt;font-family:"Calibri";line-height:1.0;page-break-after:avoid;text-align:left}h3{padding-top:14pt;color:#000000;font-weight:700;font-size:14pt;padding-bottom:4pt;font-family:"Calibri";line-height:1.0;page-break-after:avoid;text-align:left}h4{padding-top:12pt;color:#000000;font-weight:700;font-size:12pt;padding-bottom:2pt;font-family:"Calibri";line-height:1.0;page-break-after:avoid;text-align:left}h5{padding-top:11pt;color:#000000;font-weight:700;font-size:11pt;padding-bottom:2pt;font-family:"Calibri";line-height:1.0;page-break-after:avoid;text-align:left}h6{padding-top:10pt;color:#000000;font-weight:700;font-size:10pt;padding-bottom:2pt;font-family:"Calibri";line-height:1.0;page-break-after:avoid;text-align:left}</style></head><body class="c6 doc-content"><p class="c19"><span class="c5">...ificates\Case Study Files\CaseStudy03\SQL\CaseStudy03.sql&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1</span></p><p class="c23"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 615.13px; height: 1.13px;"><img alt="" src="images/image1.png" style="width: 615.13px; height: 1.13px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c15"><span class="c0">-- Step 1: Inspect the Data Structure</span></p><p class="c2"><span class="c8">SELECT TOP </span><span class="c5">10 </span><span class="c4">* </span><span class="c8">FROM </span><span class="c5">[AmazonCaseStudy]</span><span class="c4">.</span><span class="c5">[dbo]</span><span class="c4">.</span><span class="c5">[bestsellers]</span><span class="c4">;</span></p><p class="c1"><span class="c13"></span></p><p class="c18"><span class="c0">-- Step 2: Check for Missing Values </span><span class="c8">SELECT</span></p><p class="c11"><span class="c3">SUM</span><span class="c4">(</span><span class="c8">CASE WHEN Name </span><span class="c4">IS NULL </span><span class="c8">THEN </span><span class="c5">1 </span><span class="c8">ELSE </span><span class="c5">0 </span><span class="c8">END</span><span class="c4">) </span><span class="c8">AS </span><span class="c5">Missing_Name</span><span class="c4">,</span></p><p class="c10"><span class="c3">SUM</span><span class="c4">(</span><span class="c8">CASE WHEN </span><span class="c5">Author </span><span class="c4">IS NULL </span><span class="c8">THEN </span><span class="c5">1 </span><span class="c8">ELSE </span><span class="c5">0 </span><span class="c8">END</span><span class="c4">) </span><span class="c8">AS </span><span class="c5">Missing_Author</span><span class="c4">,</span></p><p class="c24"><span class="c3">SUM</span><span class="c4">(</span><span class="c8">CASE WHEN </span><span class="c5">User_Rating </span><span class="c4">IS NULL </span><span class="c8">THEN </span><span class="c5">1 </span><span class="c8">ELSE </span><span class="c5">0 </span><span class="c8">END</span><span class="c4">) </span><span class="c8">AS </span><span class="c5">Missing_User_Rating</span><span class="c4">, </span><span class="c3">SUM</span><span class="c4">(</span><span class="c8">CASE WHEN </span><span class="c5">Reviews </span><span class="c4">IS NULL </span><span class="c8">THEN </span><span class="c5">1 </span><span class="c8">ELSE </span><span class="c5">0 </span><span class="c8">END</span><span class="c4">) </span><span class="c8">AS </span><span class="c5">Missing_Reviews</span><span class="c4">, </span><span class="c3">SUM</span><span class="c4">(</span><span class="c8">CASE WHEN </span><span class="c3">Year </span><span class="c4">IS NULL </span><span class="c8">THEN </span><span class="c5">1 </span><span class="c8">ELSE </span><span class="c5">0 </span><span class="c8">END</span><span class="c4">) </span><span class="c8">AS </span><span class="c5">Missing_Year</span><span class="c4">,</span></p><p class="c11"><span class="c3">SUM</span><span class="c4">(</span><span class="c8">CASE WHEN </span><span class="c5">Genre </span><span class="c4">IS NULL </span><span class="c8">THEN </span><span class="c5">1 </span><span class="c8">ELSE </span><span class="c5">0 </span><span class="c8">END</span><span class="c4">) </span><span class="c8">AS </span><span class="c5">Missing_Genre</span></p><p class="c2"><span class="c8">FROM </span><span class="c5">[AmazonCaseStudy]</span><span class="c4">.</span><span class="c5">[dbo]</span><span class="c4">.</span><span class="c5">[bestsellers]</span><span class="c4">;</span></p><p class="c1"><span class="c13"></span></p><p class="c18"><span class="c0">-- Step 3: Check for Duplicates </span><span class="c8">SELECT </span><span class="c4">*</span></p><p class="c9"><span class="c8">FROM </span><span class="c5">[AmazonCaseStudy]</span><span class="c4">.</span><span class="c5">[dbo]</span><span class="c4">.</span><span class="c5">[bestsellers]</span></p><p class="c16"><span class="c8">GROUP BY Name</span><span class="c4">, </span><span class="c5">Author</span><span class="c4">, </span><span class="c5">[User_Rating]</span><span class="c4">, </span><span class="c5">Reviews</span><span class="c4">, </span><span class="c5">Price</span><span class="c4">, </span><span class="c3">Year</span><span class="c4">, </span><span class="c5">Genre </span><span class="c8">HAVING </span><span class="c3">COUNT</span><span class="c4">(*) &gt; </span><span class="c5">1</span><span class="c4">;</span></p><p class="c12"><span class="c14"></span></p><p class="c9"><span class="c0">-- Step 4: Data Analysis</span></p><p class="c2"><span class="c0">-- 1. Genre Distribution</span></p><p class="c2"><span class="c8">SELECT </span><span class="c5">Genre</span><span class="c4">, </span><span class="c3">COUNT</span><span class="c4">(*) </span><span class="c8">AS </span><span class="c3">Count</span></p><p class="c17"><span class="c8">FROM </span><span class="c5">[AmazonCaseStudy]</span><span class="c4">.</span><span class="c5">[dbo]</span><span class="c4">.</span><span class="c5">[bestsellers] </span><span class="c8">GROUP BY </span><span class="c5">Genre</span><span class="c4">;</span></p><p class="c12"><span class="c14"></span></p><p class="c9"><span class="c0">-- 2. Top Authors by Number of Books</span></p><p class="c17"><span class="c8">SELECT Top </span><span class="c5">10 Author</span><span class="c4">, </span><span class="c3">COUNT</span><span class="c4">(*) </span><span class="c8">AS </span><span class="c5">Book_Count </span><span class="c8">FROM </span><span class="c5">[AmazonCaseStudy]</span><span class="c4">.</span><span class="c5">[dbo]</span><span class="c4">.</span><span class="c5">[bestsellers] </span><span class="c8">GROUP BY </span><span class="c5">Author</span></p><p class="c9"><span class="c8">ORDER BY </span><span class="c5">Book_Count </span><span class="c8">DESC</span><span class="c4">;</span></p><p class="c1"><span class="c13"></span></p><p class="c9"><span class="c0">-- 3. Average User Ratig by Genre</span></p><p class="c17"><span class="c8">SELECT </span><span class="c5">Genre</span><span class="c4">, </span><span class="c3">AVG</span><span class="c4">(</span><span class="c5">User_Rating</span><span class="c4">) </span><span class="c8">AS </span><span class="c5">Avg_Rating </span><span class="c8">FROM </span><span class="c5">[AmazonCaseStudy]</span><span class="c4">.</span><span class="c5">[dbo]</span><span class="c4">.</span><span class="c5">[bestsellers] </span><span class="c8">GROUP BY </span><span class="c5">Genre</span><span class="c4">;</span></p><p class="c12"><span class="c14"></span></p><p class="c7"><span class="c0">-- 4. Yearly Trends in Bestsellers </span><span class="c8">SELECT </span><span class="c3">Year</span><span class="c4">, </span><span class="c5">Genre</span><span class="c4">, </span><span class="c3">COUNT</span><span class="c4">(*) </span><span class="c8">AS </span><span class="c3">Count</span></p><p class="c21"><span class="c8">FROM </span><span class="c5">[AmazonCaseStudy]</span><span class="c4">.</span><span class="c5">[dbo]</span><span class="c4">.</span><span class="c5">[bestsellers] </span><span class="c8">GROUP BY </span><span class="c3">Year</span><span class="c4">, </span><span class="c5">Genre</span></p><p class="c9"><span class="c8">ORDER BY </span><span class="c3">Year</span><span class="c4">, </span><span class="c5">Genre</span><span class="c4">;</span></p><p class="c1"><span class="c13"></span></p><p class="c7"><span class="c0">-- 5. Yearly Trends in Bestsellers </span><span class="c8">SELECT </span><span class="c3">Year</span><span class="c4">, </span><span class="c5">Genre</span><span class="c4">, </span><span class="c3">COUNT</span><span class="c4">(*) </span><span class="c8">AS </span><span class="c3">Count</span></p><p class="c21"><span class="c8">FROM </span><span class="c5">[AmazonCaseStudy]</span><span class="c4">.</span><span class="c5">[dbo]</span><span class="c4">.</span><span class="c5">[bestsellers] </span><span class="c8">GROUP BY </span><span class="c3">Year</span><span class="c4">, </span><span class="c5">Genre</span></p><p class="c9"><span class="c8">ORDER BY </span><span class="c3">Year</span><span class="c4">, </span><span class="c5">Genre</span><span class="c4">;</span></p><p class="c1"><span class="c13"></span></p><p class="c9"><span class="c0">-- Step 5: Save Cleaned Data</span></p><p class="c22"><span class="c0">-- (Optional: Export to a new table or export cleaned data to a CSV file using external tools)</span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 8.87px; height: 6.67px;"><img alt="" src="images/image2.png" style="width: 8.87px; height: 6.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c9"><span class="c8">SELECT </span><span class="c4">* </span><span class="c8">INTO </span><span class="c5">cleaned_bestsellers </span><span class="c8">FROM </span><span class="c5">[AmazonCaseStudy]</span><span class="c4">.</span><span class="c5">[dbo]</span><span class="c4">.</span><span class="c5">[bestsellers]</span><span class="c4">;</span></p></body></html>